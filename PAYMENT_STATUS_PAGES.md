# 📋 支付状态确认页面使用指南

## 🎯 你可以在以下页面确认支付状态：

### **1. 用户支付页面** (`/payment`)
**用户使用** - 用于查看和确认支付状态

🔗 **访问方式：**
```
http://localhost:3000/payment?orderNumber=订单号
```

📋 **功能特性：**
- ✅ **30分钟倒计时**：实时显示剩余支付时间
- 🔄 **自动刷新**：每30秒自动检查支付状态
- 📱 **手动确认**：用户可以手动确认已支付
- 🎯 **状态显示**：清晰显示支付状态（待支付/已支付/已过期）
- 🔗 **快速导航**：直接跳转到订单追踪页面

**页面特点：**
```typescript
支付状态徽章：
- 🟠 待支付：显示剩余支付时间
- 🟢 已支付：显示支付完成
- 🔴 已过期：显示支付超时

功能按钮：
- ✅ 我已支付，确认订单（用户自主确认）
- 📱 联系客服确认支付
- 📋 查看项目进度
```

---

### **2. 管理员支付管理页面** (`/admin/payment`)
**客服/管理员使用** - 批量管理和确认支付

🔗 **访问方式：**
```
http://localhost:3000/admin/payment
```

📊 **功能特性：**
- 📈 **统计概览**：待支付、已过期、已支付订单数量
- 🔍 **搜索过滤**：按订单号、客户姓名、项目标题搜索
- ⏰ **倒计时显示**：每个订单的剩余支付时间
- ✅ **批量确认**：一键确认用户支付
- 🔄 **恢复订单**：可以恢复已过期的订单
- 🧹 **处理过期**：批量处理过期订单

**管理界面分区：**
```typescript
1. 搜索栏：快速查找特定订单
2. 统计卡片：
   - 🟠 待支付订单：需要确认的订单
   - 🔴 已过期订单：超时未支付的订单  
   - 🟢 已支付订单：已确认支付的订单

3. 订单列表：
   - 待支付订单：显示倒计时，可以确认支付
   - 已过期订单：显示过期状态，可以恢复
   - 已支付订单：显示支付时间和方式
```

---

### **3. 订单追踪页面** (`/tracking`)
**用户使用** - 查看订单整体状态包括支付信息

🔗 **访问方式：**
```
http://localhost:3000/tracking
```

📝 **支付状态显示：**
- 订单详情中包含支付状态
- 显示支付截止时间
- 显示支付方式和时间（如果已支付）

---

## 🚀 使用流程

### **用户支付流程：**
```mermaid
flowchart TD
    A[用户下单] --> B[跳转支付页面]
    B --> C[查看30分钟倒计时]
    C --> D[选择支付方式]
    D --> E[完成支付]
    E --> F[点击"我已支付，确认订单"]
    F --> G[系统确认支付状态]
    G --> H[跳转订单追踪查看进度]
```

### **管理员确认流程：**
```mermaid
flowchart TD
    A[管理员登录] --> B[访问支付管理页面]
    B --> C[查看待支付订单列表]
    C --> D[核对用户支付凭证]
    D --> E[点击"确认支付"按钮]
    E --> F[系统更新订单状态]
    F --> G[发送确认通知给用户]
```

---

## 🛠️ API接口

### **用户相关：**
```bash
# 查询支付状态
GET /api/payment/status/[orderNumber]

# 用户确认支付
POST /api/payment/confirm
{
  "orderNumber": "GS202508225825",
  "paymentMethod": "alipay",
  "isManual": true,
  "operator": "customer_self_confirm"
}
```

### **管理员相关：**
```bash
# 获取订单列表
GET /api/orders?status=pending

# 管理员确认支付
POST /api/payment/confirm
{
  "orderNumber": "GS202508225825", 
  "paymentMethod": "manual",
  "isManual": true,
  "operator": "admin_user"
}

# 处理过期订单
POST /api/admin/expired-orders
```

---

## 📱 页面访问导航

### **从不同页面跳转到支付确认：**

1. **从订单页面** → 支付页面
   ```
   /order → /payment?orderNumber=订单号
   ```

2. **从订单追踪** → 支付页面
   ```
   /tracking → 点击支付链接 → /payment?orderNumber=订单号
   ```

3. **管理员后台** → 支付管理
   ```
   /admin → /admin/payment
   ```

### **页面链接关系：**
```
首页 (/)
├── 订单创建 (/order)
│   └── 支付页面 (/payment)
│       └── 订单追踪 (/tracking)
└── 管理后台 (/admin)
    └── 支付管理 (/admin/payment)
        └── 订单详情 (/admin/orders/[id])
```

---

## ✅ **总结：支付状态确认的三个入口**

1. **🙋‍♂️ 用户自主确认**：`/payment` 页面 - 用户支付后自己确认
2. **👨‍💼 管理员确认**：`/admin/payment` 页面 - 客服批量管理确认
3. **📊 状态查询**：`/tracking` 页面 - 查看支付状态和进度

**最常用的是第2个管理员页面，这是客服工作的主要界面！** 🎯